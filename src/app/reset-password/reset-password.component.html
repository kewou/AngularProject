<div class="reset-password-container">
    <!-- Form for requesting password reset -->
    <mat-card class="reset-card" *ngIf="!isResetMode">
        <mat-card-header>
            <div class="header-content">
                <mat-icon class="header-icon">lock_reset</mat-icon>
                <h1>Mot de passe oublié</h1>
                <p class="subtitle">Entrez votre adresse e-mail pour recevoir un lien de réinitialisation</p>
            </div>
        </mat-card-header>

        <mat-card-content>
            <form #resetForm="ngForm" (ngSubmit)="sentMailResetPasswordSubmit()">
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Adresse e-mail</mat-label>
                    <input matInput type="email" [(ngModel)]="formData.email" name="email" #emailInput="ngModel"
                           required email>
                    <mat-icon matSuffix>email</mat-icon>
                    <mat-error *ngIf="emailInput.errors?.['required'] && (emailInput.dirty || emailInput.touched)">
                        L'adresse e-mail est obligatoire.
                    </mat-error>
                    <mat-error *ngIf="emailInput.errors?.['email'] && (emailInput.dirty || emailInput.touched)">
                        Le format de l'adresse e-mail est invalide.
                    </mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" type="submit" class="submit-button"
                        [disabled]="resetForm.invalid">
                    <mat-icon>send</mat-icon>
                    Envoyer le lien de réinitialisation
                </button>
            </form>

            <div class="divider">
                <span>ou</span>
            </div>

            <p class="back-link">
                <a routerLink="/login">Retour à la connexion</a>
            </p>
        </mat-card-content>
    </mat-card>

    <!-- Form for updating password -->
    <mat-card class="reset-card" *ngIf="isResetMode">
        <mat-card-header>
            <div class="header-content">
                <mat-icon class="header-icon">enhanced_encryption</mat-icon>
                <h1>Créer un nouveau mot de passe</h1>
                <p class="subtitle">Définissez un mot de passe fort et sécurisé</p>
            </div>
        </mat-card-header>

        <mat-card-content>
            <form #updateForm="ngForm" (ngSubmit)="updatePasswordSubmit()"
                  [appMatchPassword]="['password', 'confirmPassword']">
                <mat-form-field appearance="outline" class="full-width" disabled>
                    <mat-label>Adresse e-mail</mat-label>
                    <input matInput type="email" [(ngModel)]="formData.email" name="email">
                    <mat-icon matSuffix>email</mat-icon>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Nouveau mot de passe</mat-label>
                    <input matInput [type]="showPass ? 'text' : 'password'" [(ngModel)]="formData.password"
                           name="password" #passwordInput="ngModel" required>
                    <button mat-icon-button matSuffix type="button" (click)="showPassword()"
                            [attr.aria-label]="showPass ? 'Masquer le mot de passe' : 'Afficher le mot de passe'">
                        <mat-icon>{{ showPass ? 'visibility_off' : 'visibility' }}</mat-icon>
                    </button>
                    <mat-hint align="start">Minimum 8 caractères requis</mat-hint>
                    <mat-error
                            *ngIf="passwordInput.errors?.['required'] && (passwordInput.dirty || passwordInput.touched)">
                        Le mot de passe est obligatoire.
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Confirmer le mot de passe</mat-label>
                    <input matInput [type]="showConfirmPass ? 'text' : 'password'"
                           [(ngModel)]="formData.confirmPassword" name="confirmPassword" #confirmPasswordInput="ngModel"
                           required>
                    <button mat-icon-button matSuffix type="button" (click)="showConfirmPassword()"
                            [attr.aria-label]="showConfirmPass ? 'Masquer le mot de passe' : 'Afficher le mot de passe'">
                        <mat-icon>{{ showConfirmPass ? 'visibility_off' : 'visibility' }}</mat-icon>
                    </button>
                    <mat-error
                            *ngIf="confirmPasswordInput.errors?.['required'] && (confirmPasswordInput.dirty || confirmPasswordInput.touched)">
                        La confirmation est obligatoire.
                    </mat-error>
                    <mat-error
                            *ngIf="confirmPasswordInput.errors?.['matching'] && (confirmPasswordInput.dirty || confirmPasswordInput.touched)">
                        Les mots de passe ne correspondent pas.
                    </mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" type="submit" class="submit-button"
                        [disabled]="updateForm.invalid">
                    <mat-icon>lock</mat-icon>
                    Mettre à jour le mot de passe
                </button>
            </form>
        </mat-card-content>
    </mat-card>
</div>
